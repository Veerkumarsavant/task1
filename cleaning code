import pandas as pd

file_path = r"C:\Users\sushm\Downloads\marketing_campaign.csv"
df = pd.read_csv(file_path, delimiter=r"\s*\t\s*", engine="python")
df.columns = df.columns.str.replace('"', '').str.strip()
for col in df.select_dtypes(include=["object"]).columns:
    df[col] = df[col].map(lambda x: str(x).replace('"', '').strip() if pd.notnull(x) else x)
df['Dt_Customer'] = pd.to_datetime(df['Dt_Customer'], format='%d-%m-%Y', errors='coerce')

for col in df.columns:
    if col not in ['Education', 'Marital_Status', 'Dt_Customer']:
        df[col] = pd.to_numeric(df[col], errors='coerce')
df.columns = df.columns.str.lower().str.replace(' ', '_')
missing_summary = df.isnull().sum()
output_path = r"C:\Users\sushm\Downloads\marketing_campaign_cleaned.csv"
df.to_csv(output_path, index=False)
print("Cleaned Dataset Preview:\n", df.head())
print("\nMissing Values:\n", missing_summary)
print(f"\nâœ… Cleaned dataset saved to: {output_path}")
